<input type="email" id="email" placeholder="Enter your email">
<button onclick="verify()">Verify & Download</button>
<div id="result"></div>

<script>
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbwKy4rZjMCZaWfbN3QPkMqENRPkxwYwyN4KaRUYPCR6Lftbo6amCynXDkD1cBVWEUM/exec";

function verify() {
  const email = document.getElementById("email").value.trim();
  const result = document.getElementById("result");

  result.innerHTML = "";

  if (!email) {
    result.innerText = "âŒ Please enter email";
    return;
  }

  fetch(WEBAPP_URL, {
  method: "POST",
  headers: {
    "Content-Type": "application/x-www-form-urlencoded"
  },
  body: "email=" + encodeURIComponent(email)
})
.then(response => {
  if (!response.ok) {
    throw new Error("Network response was not ok");
  }
  return response.text();   // ğŸ‘ˆ JSON nahi, pehle TEXT
})
.then(text => {
  console.log("RAW RESPONSE:", text);  // ğŸ‘ˆ SAB KUCH DIKHEGA
  const data = JSON.parse(text);

  if (data.status === "success" && data.downloadUrl) {
    result.innerHTML =
      "âœ… Verified<br><br>" +
      "<a href='" + data.downloadUrl + "' target='_blank'>" +
      "â¬‡ Download Certificate</a>";
  } else {
    result.innerText = "âŒ " + (data.message || "Invalid response");
  }
})
.catch(err => {
  console.error(err);
  result.innerText = "âŒ Server error";
});
  .then(r => r.json())
  .then(data => {
  console.log(data); // ğŸ‘ˆ VERY IMPORTANT

  if (data.status === "success" && data.downloadUrl) {

    result.innerHTML =
      "âœ… Verified<br><br>" +
      "<a href='" + data.downloadUrl + "' target='_blank' rel='noopener'>" +
      "â¬‡ Download Certificate</a>";

  } else {
    result.innerText = "âŒ Invalid download link";
  }
});


}
</script>
